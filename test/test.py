graph = {'ADMIRALTY': ['WOODLANDS', 'SEMBAWANG'],
 'ALJUNIED': ['PAYA LEBAR', 'KALLANG'],
 'ANG MO KIO': ['YIO CHU KANG', 'BISHAN'],
 'BARTLEY': ['TAI SENG', 'SERANGOON'],
 'BAYFRONT': ['PROMENADE', 'DOWNTOWN'],
 'BAYSHORE': ['SIGLAP', 'BEDOK SOUTH'],
 'BEAUTY WORLD': ['HILLVIEW', 'KING ALBERT PARK'],
 'BEDOK': ['TANAH MERAH', 'KEMBANGAN'],
 'BEDOK NORTH': ['KAKI BUKIT', 'BEDOK RESERVOIR'],
 'BEDOK RESERVOIR': ['BEDOK NORTH', 'TAMPINES WEST'],
 'BEDOK SOUTH': ['BAYSHORE', 'SUNGEI BEDOK'],
 'BENCOOLEN': ['FORT CANNING', 'JALAN BESAR'],
 'BENDEMEER': ['JALAN BESAR', 'GEYLANG BAHRU'],
 'BISHAN': ['LORONG CHUAN', 'MARYMOUNT', 'ANG MO KIO', 'BRADDELL'],
 'BOON KENG': ['FARRER PARK', 'POTONG PASIR'],
 'BOON LAY': ['LAKESIDE', 'PIONEER'],
 'BOTANIC GARDENS': ['CALDECOTT', 'FARRER ROAD', 'TAN KAH KEE', 'STEVENS'],
 'BRADDELL': ['BISHAN', 'TOA PAYOH'],
 'BRAS BASAH': ['DHOBY GHAUT', 'ESPLANADE'],
 'BRIGHT HILL': ['MAYFLOWER', 'UPPER THOMSON'],
 'BUANGKOK': ['HOUGANG', 'SENGKANG'],
 'BUGIS': ['ROCHOR', 'PROMENADE', 'LAVENDER', 'CITY HALL'],
 'BUKIT BATOK': ['JURONG EAST', 'BUKIT GOMBAK'],
 'BUKIT GOMBAK': ['BUKIT BATOK', 'CHOA CHU KANG'],
 'BUKIT PANJANG': ['CASHEW'],
 'BUONA VISTA': ['HOLLAND VILLAGE', 'ONE-NORTH', 'COMMONWEALTH', 'DOVER'],
 'CALDECOTT': ['UPPER THOMSON',
               'MOUNT PLEASANT',
               'MARYMOUNT',
               'BOTANIC GARDENS'],
 'CANBERRA': ['SEMBAWANG', 'YISHUN'],
 'CASHEW': ['BUKIT PANJANG', 'HILLVIEW'],
 'CHANGI AIRPORT': ['EXPO'],
 'CHINATOWN': ['TELOK AYER', 'FORT CANNING', 'OUTRAM PARK', 'CLARK QUAY'],
 'CHINESE GARDEN': ['JURONG EAST', 'LAKESIDE'],
 'CHOA CHU KANG': ['BUKIT GOMBAK', 'YEW TEE'],
 'CITY HALL': ['DHOBY GHAUT', 'RAFFLES PLACE', 'BUGIS'],
 'CLARK QUAY': ['CHINATOWN', 'DHOBY GHAUT'],
 'CLEMENTI': ['DOVER', 'JURONG EAST'],
 'COMMONWEALTH': ['QUEENSTOWN', 'BUONA VISTA'],
 'DAKOTA': ['MOUNTBATTEN', 'PAYA LEBAR'],
 'DHOBY GHAUT': ['BRAS BASAH',
                 'SOMERSET',
                 'CITY HALL',
                 'CLARK QUAY',
                 'LITTLE INDIA'],
 'DOVER': ['BUONA VISTA', 'CLEMENTI'],
 'DOWNTOWN': ['BAYFRONT', 'TELOK AYER'],
 'ESPLANADE': ['BRAS BASAH', 'PROMENADE'],
 'EUNOS': ['KEMBANGAN', 'PAYA LEBAR'],
 'EXPO': ['TANAH MERAH', 'CHANGI AIRPORT', 'UPPER CHANGI'],
 'FARRER PARK': ['LITTLE INDIA', 'BOON KENG'],
 'FARRER ROAD': ['BOTANIC GARDENS', 'HOLLAND VILLAGE'],
 'FORT CANNING': ['CHINATOWN', 'BENCOOLEN'],
 "FOUNDERS' MEMORIAL": ['GARDENS BY THE BAY', 'TANJONG RHU'],
 'GARDENS BY THE BAY': ['MARINA BAY', "FOUNDERS' MEMORIAL"],
 'GEYLANG BAHRU': ['BENDEMEER', 'MATTAR'],
 'GREAT WORLD': ['ORCHARD', 'HAVELOCK'],
 'GUL CIRCLE': ['JOO KOON', 'TUAS CRESCENT'],
 'HARBOURFRONT': ['TELOK BLANGAH', 'OUTRAM PARK'],
 'HAVELOCK': ['GREAT WORLD', 'OUTRAM PARK'],
 'HAW PAR VILLA': ['KENT RIDGE', 'PASIR PANJANG'],
 'HILLVIEW': ['CASHEW', 'BEAUTY WORLD'],
 'HOLLAND VILLAGE': ['FARRER ROAD', 'BUONA VISTA'],
 'HOUGANG': ['KOVAN', 'BUANGKOK'],
 'JALAN BESAR': ['BENCOOLEN', 'BENDEMEER'],
 'JOO KOON': ['PIONEER', 'GUL CIRCLE'],
 'JURONG EAST': ['BUKIT BATOK', 'CLEMENTI', 'CHINESE GARDEN'],
 'KAKI BUKIT': ['UBI', 'BEDOK NORTH'],
 'KALLANG': ['ALJUNIED', 'LAVENDER'],
 'KATONG PARK': ['TANJONG RHU', 'TANJONG KATONG'],
 'KEMBANGAN': ['BEDOK', 'EUNOS'],
 'KENT RIDGE': ['ONE-NORTH', 'HAW PAR VILLA'],
 'KHATIB': ['YISHUN', 'YIO CHU KANG'],
 'KING ALBERT PARK': ['BEAUTY WORLD', 'SIXTH AVENUE'],
 'KOVAN': ['SERANGOON', 'HOUGANG'],
 'KRANJI': ['YEW TEE', 'MARSILING'],
 'LABRADOR PARK': ['PASIR PANJANG', 'TELOK BLANGAH'],
 'LAKESIDE': ['CHINESE GARDEN', 'BOON LAY'],
 'LAVENDER': ['KALLANG', 'BUGIS'],
 'LENTOR': ['SPRINGLEAF', 'MAYFLOWER'],
 'LITTLE INDIA': ['NEWTON', 'ROCHOR', 'DHOBY GHAUT', 'FARRER PARK'],
 'LORONG CHUAN': ['SERANGOON', 'BISHAN'],
 'MACPHERSON': ['PAYA LEBAR', 'TAI SENG', 'MATTAR', 'UBI'],
 'MARINA BAY': ['SHENTON WAY',
                'GARDENS BY THE BAY',
                'RAFFLES PLACE',
                'MARINA SOUTH PIER'],
 'MARINA SOUTH PIER': ['MARINA BAY'],
 'MARINE PARADE': ['TANJONG KATONG', 'MARINE TERRACE'],
 'MARINE TERRACE': ['MARINE PARADE', 'SIGLAP'],
 'MARSILING': ['KRANJI', 'WOODLANDS'],
 'MARYMOUNT': ['BISHAN', 'CALDECOTT'],
 'MATTAR': ['GEYLANG BAHRU', 'MACPHERSON'],
 'MAXWELL': ['OUTRAM PARK', 'SHENTON WAY'],
 'MAYFLOWER': ['LENTOR', 'BRIGHT HILL'],
 'MOUNT PLEASANT': ['CALDECOTT', 'STEVENS'],
 'MOUNTBATTEN': ['STADIUM', 'DAKOTA'],
 'NAPIER': ['STEVENS', 'ORCHARD BOULEVARD'],
 'NEWTON': ['STEVENS', 'LITTLE INDIA', 'NOVENA', 'ORCHARD'],
 'NICOLL HIGHWAY': ['PROMENADE', 'STADIUM'],
 'NOVENA': ['TOA PAYOH', 'NEWTON'],
 'ONE-NORTH': ['BUONA VISTA', 'KENT RIDGE'],
 'ORCHARD': ['ORCHARD BOULEVARD', 'GREAT WORLD', 'NEWTON', 'SOMERSET'],
 'ORCHARD BOULEVARD': ['NAPIER', 'ORCHARD'],
 'OUTRAM PARK': ['HAVELOCK',
                 'MAXWELL',
                 'HARBOURFRONT',
                 'CHINATOWN',
                 'TANJONG PAGAR',
                 'TIONG BAHRU'],
 'PASIR PANJANG': ['HAW PAR VILLA', 'LABRADOR PARK'],
 'PASIR RIS': ['TAMPINES'],
 'PAYA LEBAR': ['DAKOTA', 'MACPHERSON', 'EUNOS', 'ALJUNIED'],
 'PIONEER': ['BOON LAY', 'JOO KOON'],
 'POTONG PASIR': ['BOON KENG', 'WOODLEIGH'],
 'PROMENADE': ['ESPLANADE', 'NICOLL HIGHWAY', 'BUGIS', 'BAYFRONT'],
 'PUNGGOL': ['SENGKANG'],
 'QUEENSTOWN': ['REDHILL', 'COMMONWEALTH'],
 'RAFFLES PLACE': ['CITY HALL', 'MARINA BAY', 'TANJONG PAGAR'],
 'REDHILL': ['TIONG BAHRU', 'QUEENSTOWN'],
 'ROCHOR': ['LITTLE INDIA', 'BUGIS'],
 'SEMBAWANG': ['ADMIRALTY', 'CANBERRA'],
 'SENGKANG': ['BUANGKOK', 'PUNGGOL'],
 'SERANGOON': ['BARTLEY', 'LORONG CHUAN', 'WOODLEIGH', 'KOVAN'],
 'SHENTON WAY': ['MAXWELL', 'MARINA BAY'],
 'SIGLAP': ['MARINE TERRACE', 'BAYSHORE'],
 'SIMEI': ['TAMPINES', 'TANAH MERAH'],
 'SIXTH AVENUE': ['KING ALBERT PARK', 'TAN KAH KEE'],
 'SOMERSET': ['ORCHARD', 'DHOBY GHAUT'],
 'SPRINGLEAF': ['WOODLANDS SOUTH', 'LENTOR'],
 'STADIUM': ['NICOLL HIGHWAY', 'MOUNTBATTEN'],
 'STEVENS': ['MOUNT PLEASANT', 'NAPIER', 'BOTANIC GARDENS', 'NEWTON'],
 'SUNGEI BEDOK': ['BEDOK SOUTH'],
 'TAI SENG': ['MACPHERSON', 'BARTLEY'],
 'TAMPINES': ['TAMPINES WEST', 'TAMPINES EAST', 'PASIR RIS', 'SIMEI'],
 'TAMPINES EAST': ['TAMPINES', 'UPPER CHANGI'],
 'TAMPINES WEST': ['BEDOK RESERVOIR', 'TAMPINES'],
 'TAN KAH KEE': ['SIXTH AVENUE', 'BOTANIC GARDENS'],
 'TANAH MERAH': ['EXPO', 'SIMEI', 'BEDOK'],
 'TANJONG KATONG': ['KATONG PARK', 'MARINE PARADE'],
 'TANJONG PAGAR': ['RAFFLES PLACE', 'OUTRAM PARK'],
 'TANJONG RHU': ["FOUNDERS' MEMORIAL", 'KATONG PARK'],
 'TELOK AYER': ['DOWNTOWN', 'CHINATOWN'],
 'TELOK BLANGAH': ['LABRADOR PARK', 'HARBOURFRONT'],
 'TIONG BAHRU': ['OUTRAM PARK', 'REDHILL'],
 'TOA PAYOH': ['BRADDELL', 'NOVENA'],
 'TUAS CRESCENT': ['GUL CIRCLE', 'TUAS WEST ROAD'],
 'TUAS LINK': ['TUAS WEST ROAD'],
 'TUAS WEST ROAD': ['TUAS CRESCENT', 'TUAS LINK'],
 'UBI': ['MACPHERSON', 'KAKI BUKIT'],
 'UPPER CHANGI': ['TAMPINES EAST', 'EXPO'],
 'UPPER THOMSON': ['BRIGHT HILL', 'CALDECOTT'],
 'WOODLANDS': ['WOODLANDS NORTH', 'WOODLANDS SOUTH', 'MARSILING', 'ADMIRALTY'],
 'WOODLANDS NORTH': ['WOODLANDS'],
 'WOODLANDS SOUTH': ['WOODLANDS', 'SPRINGLEAF'],
 'WOODLEIGH': ['POTONG PASIR', 'SERANGOON'],
 'YEW TEE': ['CHOA CHU KANG', 'KRANJI'],
 'YIO CHU KANG': ['KHATIB', 'ANG MO KIO'],
 'YISHUN': ['CANBERRA', 'KHATIB']
 }

def bfs_shortest_path(graph: dict, start_station: str ,end_station: str) -> list: # list of list(paths)
    start_station = start_station.upper()
    end_station = end_station.upper()
    queue: list = [[start_station]] # list of path
    visited: list  = []
    paths: list = []
    path: list = []
    while queue:
        #print(f"Queue : {queue}")
        path = queue.pop(0)
        #print(f"Path : {path}")
        last_station = path[-1]
        if last_station == end_station:
            return path
        if last_station not in visited:
            visited.append(last_station)

            for neighbour in graph[last_station]:
                if neighbour not in visited:
                    new_path = path + [neighbour]
                    queue.append(new_path)
    return None

paths = bfs_shortest_path(graph, 'CITY HALL', 'TUAS LINK') # should return list of all possible paths

def count_line_changes(path, station_lines):
    prev_lines = station_lines.get(path[0], [])
    changes = 0
    for station in path[1:]:
        current_lines = station_lines.get(station, [])
        if not set(prev_lines) & set(current_lines):
            changes += 1
        prev_lines = current_lines
    return changes

station_lines = {
    'CITY HALL': ['EAST WEST'],
    'RAFFLES PLACE': ['EAST WEST'],
    'TANJONG PAGAR': ['EAST WEST'],
    'OUTRAM PARK': ['EAST WEST', 'NORTH EAST', 'THOMSON-EAST COAST'],
    'TIONG BAHRU': ['EAST WEST'],
    'REDHILL': ['EAST WEST'],
    'QUEENSTOWN': ['EAST WEST'],
    'COMMONWEALTH': ['EAST WEST'],
    'BUONA VISTA': ['EAST WEST', 'CIRCLE'],
    'DOVER': ['EAST WEST'],
    'CLEMENTI': ['EAST WEST'],
    'JURONG EAST': ['EAST WEST', 'NORTH SOUTH'],
    'CHINESE GARDEN': ['EAST WEST'],
    'LAKESIDE': ['EAST WEST'],
    'BOON LAY': ['EAST WEST'],
    'PIONEER': ['EAST WEST'],
    'JOO KOON': ['EAST WEST'],
    'GUL CIRCLE': ['EAST WEST'],
    'TUAS CRESCENT': ['EAST WEST'],
    'TUAS WEST ROAD': ['EAST WEST'],
    'TUAS LINK': ['EAST WEST'],

    'DHOBY GHAUT': ['NORTH SOUTH', 'NORTH EAST', 'CIRCLE'],
    'LITTLE INDIA': ['NORTH EAST', 'DOWNTOWN'],
    'NEWTON': ['NORTH SOUTH', 'DOWNTOWN'],
    'STEVENS': ['DOWNTOWN', 'THOMSON-EAST COAST'],
    'BOTANIC GARDENS': ['CIRCLE', 'DOWNTOWN'],
    'FARRER ROAD': ['CIRCLE'],
    'HOLLAND VILLAGE': ['CIRCLE'],
    'ONE-NORTH': ['CIRCLE'],
    'KENT RIDGE': ['CIRCLE'],
}

#def count_line_changes(path, station_lines):
#    if len(path) < 2:
#        return 0
#
#    # Try all common lines for the first two stations
#    first, second = path[0], path[1]
#    possible_lines = list(set(station_lines.get(first, [])) & set(station_lines.get(second, [])))
#
#    if not possible_lines:
#        return float('inf')  # Not connected
#
#    min_changes = float('inf')
#
#    for initial_line in possible_lines:
#        changes = 0
#        current_line = initial_line
#
#        for i in range(1, len(path)):
#            prev, curr = path[i - 1], path[i]
#            lines_prev = station_lines.get(prev, [])
#            lines_curr = station_lines.get(curr, [])
#            if current_line not in lines_prev or current_line not in lines_curr:
#                # Need to switch
#                shared = set(lines_prev) & set(lines_curr)
#                if shared:
#                    # Pick a new common line
#                    current_line = list(shared)[0]
#                    changes += 1
#                else:
#                    return float('inf')  # Not reachable
#
#        if changes < min_changes:
#            min_changes = changes
#
#    return min_changes

path = ['CITY HALL', 'DHOBY GHAUT', 'LITTLE INDIA', 'NEWTON', 'STEVENS', 'BOTANIC GARDENS', 'FARRER ROAD', 'HOLLAND VILLAGE', 'BUONA VISTA', 'DOVER', 'CLEMENTI', 'JURONG EAST', 'CHINESE GARDEN', 'LAKESIDE', 'BOON LAY', 'PIONEER', 'JOO KOON', 'GUL CIRCLE', 'TUAS CRESCENT', 'TUAS WEST ROAD', 'TUAS LINK']
min_changes = count_line_changes(path, station_lines)
print(min_changes)

changes = count_line_changes(paths, station_lines)
print(changes)
print(paths)

